---
title: "Produce 101 seasons 1 & 2 data analysis"
output: 
  html_document:
    toc: true
    toc_float: true
  
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = TRUE, message=FALSE, echo = F)
#options(knitr.table.format = "html")
# ioslides_presentation:
#     widescreen: true
#     smaller: true
#date: October 19, 2017
#author: Olina Liang
#question, obtaining data, exploration, modeling, conclusion
#html, slides, shiny
```
# Produce 101
## Introduction
- Produce 101 is a korean survival reality show on Mnet. 
- It is a large-scale project in which the public (called 'national producers') "produces" a unit group by choosing 11 members among 101 trainees from over 50 entertainment companies.
- The show has 11 episodes.
- In the first two episodes, the trainees' are ranked by judges from A to E based on their perfromance which determines their position in the first trailor. And in each episode, their ranking are calculated by votings by viewers, the bottom ones are eliminated.
- There are different votings based on their performance in different tasks.
- Season 1 consist of all girls while season 2 is all boys.
- This project aims to explore which kind of trainees are more likely to debut.

## Packages
```{r, message=FALSE, echo = T}
library(readxl)
library(rvest)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(stringr)
library(ggvis)
library(ggbio)
library(knitr)
library(kableExtra)
library(dplyr)
library(plotly)
```

# Cleaning data
## Data
- Data from webpage (Wikipedia)
- https://en.wikipedia.org/wiki/List_of_Produce_101_contestants
- https://en.wikipedia.org/wiki/List_of_Produce_101_Season_2_contestants
- Korean TV show produce 101, seasons 1 and 2
- Tables for overall rank & performances for different tasks

##get data from web
```{r}
#s1
webpage1 <- read_html("https://en.wikipedia.org/wiki/List_of_Produce_101_contestants")
#table 1
tbls_s1 <- webpage1 %>%
  html_nodes("table")%>%
  .[1] %>%
  html_table(fill = TRUE)
pd101_s1_trainee <- tbls_s1[[1]]
#s2
webpage2 <- read_html("https://en.wikipedia.org/wiki/List_of_Produce_101_Season_2_contestants")
#table 1
tbls_s2 <- webpage2 %>%
  html_nodes("table")%>%
  .[1] %>%
  html_table(fill = T)
pd101_s2_trainee <- tbls_s2[[1]]
```
```{r}
pd101_s2_trainee
```

#Clean data (function)
- Cleaned name of trainees
- Changed type of age and ranking to integers
- Assigned evaluation numeric values
```{r}
clean_data <- function(df){
  df$Company <- str_replace_all(df$Company, "[^[:ascii:]]", "") %>%
  str_replace_all("\\(.*\\)", "")
df$Name <- str_replace_all(df$Name, "[^[:ascii:]]", "") %>%
  str_replace_all("\\(.*\\)", "") 
df$Name <- gsub("[[:digit:]]", "", df$Name)
names(df) <-  make.names(names(df), unique = T)

df$Ranking.4 <- str_replace_all(df$Ranking.4, ",", "")
df$Ranking.7 <- str_replace_all(df$Ranking.7, ",", "") 
df$Ranking.9 <- str_replace_all(df$Ranking.9, ",", "")
df$Ranking.11 <- str_replace_all(df$Ranking.11, ",", "") 

#clean first few rows
df <- 
  filter(df, Age>10&Age<50) %>%
#convert types
mutate(Age = type.convert(Age), 
       Ranking = type.convert(Ranking),
       Ranking.1 = as.numeric(Ranking.1),#ep2 ranking
       Ranking.2 = as.numeric(Ranking.2),
       Ranking.3 = as.numeric(Ranking.3),
      Ranking.4 = as.numeric(Ranking.4),
       Ranking.5 = as.numeric(Ranking.5),
       Ranking.6 = as.numeric(Ranking.6),
       Ranking.7 = as.numeric(Ranking.7),
       Ranking.8 = as.numeric(Ranking.8),
       Ranking.9 = as.numeric(Ranking.9),
       Ranking.10 = as.numeric(Ranking.10),
       Ranking.11= as.numeric(Ranking.11),
       Ranking.12 = as.numeric(Ranking.12),
      
       Judges.evaluation = type.convert(Judges.evaluation),
       evaluation1_num = as.numeric(Judges.evaluation),
       Judges.evaluation.1 = type.convert(Judges.evaluation.1),
       evaluation2_num = as.numeric(Judges.evaluation.1)
       ) %>%
  mutate(Name = str_trim(Name)) %>%
  mutate(Company = str_trim(Company))
#rename variables
colnames(df)[colnames(df)=="Ranking"] <- "Ranking_ep1"
colnames(df)[colnames(df)=="Ranking.1"] <- "Ranking_ep2"
colnames(df)[colnames(df)=="Ranking.2"] <- "Ranking_ep3"
colnames(df)[colnames(df)=="Ranking.3"] <- "Ranking_ep5"
colnames(df)[colnames(df)=="Ranking.4"] <- "Votes_ep5"
colnames(df)[colnames(df)=="Ranking.5"] <- "Ranking_ep6"
colnames(df)[colnames(df)=="Ranking.6"] <- "Ranking_ep8"
colnames(df)[colnames(df)=="Ranking.7"] <- "Votes_ep8"
colnames(df)[colnames(df)=="Ranking.8"] <- "Ranking_ep10"
colnames(df)[colnames(df)=="Ranking.9"] <- "Votes_ep10"
colnames(df)[colnames(df)=="Ranking.10"] <- "Ranking_ep11"
colnames(df)[colnames(df)=="Ranking.11"] <- "Votes_ep11"
colnames(df)[colnames(df)=="Ranking.12"] <- "Ranking_final"
colnames(df)[colnames(df)=="Judges.evaluation"] <- "Evaluation1"
colnames(df)[colnames(df)=="Judges.evaluation.1"] <- "Evaluation2"
  df
}

#s1
pd101_s1_trainee <- clean_data(pd101_s1_trainee)
pd101_s1_trainee <- pd101_s1_trainee %>%
  mutate (Gender = "F",
          evaluation2_num = evaluation2_num - 1)

#s2
pd101_s2_trainee <- clean_data(pd101_s2_trainee)
pd101_s2_trainee <- pd101_s2_trainee %>%
  mutate (Gender = "M")

pd101_s1_trainee
```

##Combine tables
- Combine table containing info about height, weight and training time
```{r}
pd101_s1_heights <- read_csv("pd101_heights_s1.csv")
pd101_s2_heights <- read_csv("pd101_heights_s2.csv")

pd101_s1_trainee <- pd101_s1_trainee %>% 
  left_join(pd101_s1_heights, by = "Name")

pd101_s2_trainee <- pd101_s2_trainee %>% 
  left_join(pd101_s2_heights, by = "Name")
```

## Calculations
- Calculate training time(months) from training month & year.
```{r}
pd101_s1_trainee <- pd101_s1_trainee %>%
  mutate(Training_time = Training_time_month + Training_time_years*12,
         Evaluation_diff = evaluation2_num - evaluation1_num)

pd101_s2_trainee <- pd101_s2_trainee %>%
  mutate(Training_time = Training_time_month + Training_time_years*12,
         Evaluation_diff = evaluation2_num - evaluation1_num)
```

## Combine to one big df
```{r}
df <- rbind(pd101_s1_trainee, pd101_s2_trainee)
```



### Data table season 1
```{r}
kable(pd101_s1_trainee, "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive")) %>%
  scroll_box(width = "90%", height = "300px")
```

### Data table season 2
```{r}
kable(pd101_s2_trainee, "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive")) %>%
  scroll_box(width = "90%", height = "300px")
```

### Combined table
```{r}
kable(df, "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive")) %>%
  scroll_box(width = "90%", height = "300px")
```


# Analysis of single variable
## Methods
- analyze_variable: analyze single variable. Output a list of two tables: cut the variable into 4 intervals; calculate average by gender. For example: analyze_variable("Age").
- graph_variable: bar plot of single variable by gender, and frequncy comparison. In both ggplot and plotly. For example: graph_variable("Age").

```{r}
analyze_variable <- function(x){
  range <- max(df[[rlang::UQ(rlang::sym(x))]], na.rm = T) - min(df[[rlang::UQ(rlang::sym(x))]], na.rm = T)
a <- df %>%
  count(cut_width(rlang::UQ(rlang::sym(x)), range/4))
b <- df %>%
  group_by(Gender) %>%
  summarise(mean = mean(rlang::UQ(rlang::sym(x)), na.rm = T))
list(a,b)
}

graph_variable <- function(x){
t1 <- ggplot(data = pd101_s1_trainee) +
 geom_bar(mapping = aes (x = pd101_s1_trainee[[rlang::UQ(rlang::sym(x))]]), color = "palevioletred1")
t1 <- ggplotly(t1, xaxis = ~paste0(x, id))
t2 <- ggplot(data = pd101_s2_trainee) +
 geom_bar(mapping = aes (x = pd101_s2_trainee[[rlang::UQ(rlang::sym(x))]]), color = "steelblue2")
t2 <- ggplotly(t2, xaxis = ~paste0(x, id))
t3 <- ggplot(df) +
  geom_freqpoly(mapping = aes(x = df[[rlang::UQ(rlang::sym(x))]], color = Gender)) +
  scale_color_manual(values=c("#ff82ab", "#5cacee")) +
  xlab(x)
t3 <- ggplotly(t3)
tt <- subplot(t1, t2, shareY = TRUE)
p1 <- subplot(tt, t3, nrows = 2, margin = 0.05, heights = c(0.45, 0.55))
p2 <- df %>%
  ggplot(aes(cut_interval(df[[rlang::UQ(rlang::sym(x))]], 20), fill = factor(Gender))) +
  geom_bar(position = "dodge2") +
  scale_fill_manual(values=c("#ff82ab", "#5cacee")) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  xlab(x)

list(tt,t3,p1, p2)
}
```

## Age of trainees
### Distribution
```{r}
analyze_variable("Age")[1]
```
```{r}
analyze_variable("Age")[2]
```

### Graph
- Most female trainees around 20 years old.
- Most male trainees around 23 years old.
- Age of female trainees are generally younger than male trainees.
```{r}
graph_variable("Age")
```

## Height of trainees
### Distribution
```{r}
analyze_variable("Height")[1]
```
```{r}
analyze_variable("Height")[2]
```

### Graph
```{r}
graph_variable("Height")
```

## Weight of trainees
### Distribution
```{r}
analyze_variable("Weight")[1]
```
```{r}
analyze_variable("Weight")[2]
```

### Graph
```{r}
graph_variable("Weight")
```

## Training time of trainees
### Distribution
```{r}
analyze_variable("Training_time")[1]
```
```{r}
analyze_variable("Training_time")[2]
```

###Graph
```{r}
graph_variable("Training_time")
```

## Votes
### Distribution
```{r}
analyze_variable("Votes_ep5")[1]
```
```{r}
analyze_variable("Votes_ep5")[2]
```
```{r}
graph_variable("Votes_ep5")[2]
```

Do people keep voting if their favorite trainees get eliminated?
 - Top 60 in ep 6
 - Top 35 in ep 10
 - Top 20/22 in ep 11
 Other factors that influece.
```{r, eval=F}
# can investigate more about voting
# how does the voting policy influence the votes
analyze_variable("Votes_ep5")[2]
analyze_variable("Votes_ep8")[2]
analyze_variable("Votes_ep10")[2]
analyze_variable("Votes_ep11")[2]

graph_variable("Votes_ep11")[2]

#calculate total number of votes

df %>%
  group_by(Gender) %>%
  summarise(ep5_total = prettyNum(sum(Votes_ep5, na.rm = T),big.mark=",",scientific=FALSE),
            ep8_total = prettyNum(sum(Votes_ep8, na.rm = T),big.mark=",",scientific=FALSE),
            ep10_total = prettyNum(sum(Votes_ep10, na.rm = T),big.mark=",",scientific=FALSE),
            ep11_total = prettyNum(sum(Votes_ep11, na.rm = T),big.mark=",",scientific=FALSE))
```

# Analysis of relationships
## Age and ranking comparison
- The ranking in first episode is more based on first impression while final ranking is based on viewers' holistic evaluation of a trainee.
- Lighter color represents ranking in first episode, darker represents ranking in last episode
- Left one cut by number, right one cut by age interval
- The younger trainees' ranking tend to increase while the older trainees' ranking tend to decrease.


- Cut by number on the left, cut by age interval on the right.
- Girls around 20 has best ranking, while younger boys (~17) have best ranking.

```{r, warning=F}
#season1
t1 <- ggplot(data = pd101_s1_trainee) + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_ep1, group = cut_number(Age, 5)), alpha = 0.4, color = "palevioletred1") + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_final, group = cut_number(Age, 5)),alpha = 0.3, color = "palevioletred4")

t2<- ggplot(data = pd101_s1_trainee) + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_ep1, group = cut_width(Age, 3)), alpha = 0.4, color = "palevioletred1") + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_final, group = cut_width(Age, 3)),alpha = 0.3, color = "palevioletred4")

#season2
t3 <- ggplot(data = pd101_s2_trainee) + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_ep1, group = cut_number(Age, 5)), alpha = 0.4, color = "steelblue2") + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_final, group = cut_number(Age, 5)),alpha = 0.3, color = "steelblue4")

t4<- ggplot(data = pd101_s2_trainee) + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_ep1, group = cut_width(Age, 3)), alpha = 0.4, color = "steelblue2") + 
  geom_boxplot(mapping = aes(x = Age, y = Ranking_final, group = cut_width(Age, 3)),alpha = 0.3, color = "steelblue4")

grid.arrange(t1, t2, t3, t4, ncol=2)
```


# Judge evaluation
## Comparison of distribution for the two rankings
- Most people in F, least in A
- More people in A for the second time

## Distribution in season 2
- Evaluation increased and least in A class. Probably planned by the show.
```{r}
t1 <- pd101_s1_trainee %>%
  filter(evaluation1_num>0) %>% 
  ggplot() +
 geom_bar(mapping = aes (x = Evaluation1), color = "palevioletred1")

t2 <- pd101_s1_trainee %>%
  filter(evaluation2_num>0) %>% ggplot() +
 geom_bar(mapping = aes (x = Evaluation2), color = "palevioletred1")

t3 <- ggplot(data = pd101_s2_trainee) +
 geom_bar(mapping = aes (x = Evaluation1), color = "steelblue2")

t4 <- ggplot(data = pd101_s2_trainee) +
 geom_bar(mapping = aes (x = Evaluation2), color = "steelblue2")

grid.arrange(t1, t2, t3, t4, ncol=2)
```

##Ranking and judge evaluation for season 2
- Evaluation for top 20
- Not really depend on evaluation
```{r}
t1 <- pd101_s1_trainee %>%
  filter(evaluation2_num>0) %>% 
  filter(Ranking_ep11>0) %>%
ggplot() +
 geom_bar(mapping = aes (x = Evaluation2), color = "palevioletred1")

t2 <- pd101_s2_trainee %>%
  filter(evaluation2_num>0) %>% 
  filter(Ranking_ep11>0) %>%
ggplot() +
 geom_bar(mapping = aes (x = Evaluation2), color = "steelblue2")

grid.arrange(t1, t2, ncol=2)
```

## Evaluation and traning time for season 2

```{r}
t1 <- df %>% 
  filter(Gender == "F") %>%
  ggplot() + 
geom_boxplot(aes(x = evaluation1_num, y = Training_time, 
                 group = cut_width(evaluation1_num, 1)), color = "palevioletred1")

t2 <- df %>% 
  filter(Gender == "M") %>%
  ggplot() + 
geom_boxplot(aes(x = evaluation1_num, y = Training_time, 
                 group = cut_width(evaluation1_num, 1)), color = "steelblue2")

grid.arrange(t1, t2, ncol=2)
```

## Rankings and judge evaluation
- A,B,C,D,F
- A(best) = 1, F(worst) = 5

```{r}
t1 <- df %>% 
  filter(Gender == "F") %>%
  ggplot(aes(x = Ranking_ep3 - Ranking_ep1, y = Evaluation_diff)) + 
geom_point(color = "palevioletred1") +
  geom_smooth(method = "lm")

t2 <- df %>% 
  filter(Gender == "M") %>%
  ggplot(aes(x = Ranking_ep3 - Ranking_ep1, y = Evaluation_diff)) + 
geom_point(color = "steelblue2") +
  geom_smooth(method = "lm")

grid.arrange(t1, t2, ncol=2)
```


## Group by companies

try use filter to do this...
```{r}
df %>%
  group_by(Company)%>%
  count() %>%
  arrange(desc(n)) %>%
  filter(n > 4) 

df %>%
  filter(Gender == "F") %>%
  group_by(Company) %>%
  count() %>%
  arrange(desc(n)) 

df %>%
  filter(Gender == "M") %>%
  group_by(Company) %>%
  count() %>%
  arrange(desc(n))


a <- df %>%
  filter(Company == "Individual Trainee"|Company =="Pledis Entertainment"|
           #Company == "Happy Face Entertainment"|
           Company == "Blessing Entertainment"|
           Company == "Fantagio"|
           Company == "Cube Entertainment"|
           Company == "Starship Entertainment") %>%
  group_by(Company, Gender) %>%
  summarise(mean(Ranking_final))
a
  ggplot(a) +
  geom_point(mapping = aes(x = Company, y = `mean(Ranking_final)`, color = Gender)) +
    theme(axis.text.x = element_text(angle = 60, hjust = 1))

df %>%
  filter(Company == "Individual Trainee"|Company =="Pledis Entertainment"|
           #Company == "Happy Face Entertainment"|
           Company == "Blessing Entertainment"|
           Company == "Fantagio"|
           Company == "Cube Entertainment"|
           Company == "Starship Entertainment") %>%
  ggplot() +
  geom_point(mapping = aes(x = Company, y = Ranking_final, color = Gender)) +
    theme(axis.text.x = element_text(angle = 60, hjust = 1))
  
df %>%
  filter(Company == "Individual Trainee"|Company =="Pledis Entertainment"|
           #Company == "Happy Face Entertainment"|
           Company == "Blessing Entertainment"|
           Company == "Fantagio"|
           Company == "Cube Entertainment"|
           Company == "Starship Entertainment") %>%
  ggplot() +
  geom_boxplot(mapping = aes(x = Company, y = Ranking_final, color = Gender)) +
    theme(axis.text.x = element_text(angle = 60, hjust = 1))


  
```

## Company rankings and judge evaluation
```{r, eval=F}
trainee_company_s1_top_e1 <-
  group_by(pd101_s1_tbl1, Company) %>%
  summarise(ranking = mean(ranking_ep1, na.rm = T),
            n_of_trainee = n(), 
            evaluation = mean(evaluation1_num)) %>%
  arrange(desc(n_of_trainee)) %>%
  filter(n_of_trainee >= 3)

trainee_company_s1_top_e2 <-
  group_by(pd101_s1_tbl1, Company) %>%
  summarise(ranking = mean(ranking_ep2, na.rm = T),
            n_of_trainee = n(), 
            evaluation = mean(evaluation2_num)) %>%
  arrange(desc(n_of_trainee)) %>%
  filter(n_of_trainee >= 3)
#trainee_company_s1_top_e1

trainee_company_s2_top_e1 <-
  group_by(pd101_s2_tbl1, Company) %>%
  summarise(ranking = mean(ranking_ep1, na.rm = T), 
            n_of_trainee = n(),
            evaluation = mean(evaluation1_num)) %>%
  arrange(desc(n_of_trainee)) %>%
  filter(n_of_trainee >= 3)

trainee_company_s2_top_e2 <-
  group_by(pd101_s2_tbl1, Company) %>%
  summarise(ranking = mean(ranking_ep2, na.rm = T),
            n_of_trainee = n(), 
            evaluation = mean(evaluation2_num)) %>%
  arrange(desc(n_of_trainee)) %>%
  filter(n_of_trainee >= 3)
#trainee_company_s2_top

#ep1 ranking vs. evaluation
ep1 <- ggplot() +
  geom_point(trainee_company_s1_top_e1, mapping = aes(x = ranking, y = Company, color = evaluation), size = 4) +
  geom_point(trainee_company_s2_top_e1, mapping = aes(x = ranking, y = Company, color = evaluation), size = 4, shape = 17)
ep1

#ep2 ranking vs. evaluation
ep2 <- ggplot() +
  geom_point(trainee_company_s1_top_e2, mapping = aes(x = ranking, y = Company, color = evaluation), size = 4)+
  geom_point(trainee_company_s2_top_e2, mapping = aes(x = ranking, y = Company, color = evaluation), size = 4, shape = 17)
ep2

tracks(Episode1 = ep1, Episode2 = ep2, main = "Ranking vs. Evaluation")
```

## Company rankings and judge evaluation
```{r, eval=F}
trainee_company_s1_top_individuals <-
  group_by(pd101_s1_tbl1, Company) %>%
  mutate(n_of_trainee = n()) %>%
  filter(n_of_trainee >= 5) %>%
  ungroup()

#trainee_company_s1_top_individuals

trainee_company_s2_top_individuals <-
  group_by(pd101_s2_tbl1, Company) %>%
  mutate(n_of_trainee = n()) %>%
  filter(n_of_trainee >= 5) %>%
  ungroup()

#trainee_company_s2_top_individuals

ggplot() +
  geom_point(trainee_company_s1_top_individuals, mapping = aes(x = ranking, y = evaluation1_num, color = Company)) +
  geom_point(trainee_company_s2_top_individuals, mapping = aes(x = ranking, y = evaluation1_num, color = Company), shape = 17)
```



##Height and ranking
```{r, eval=F}
ggplot(data = pd101_s2_tbl1, aes(x = Height, y = ranking)) +
  geom_point(color = "blue")

ggplot(data = pd101_s2_tbl1, aes(x = Height, y = ranking)) + 
  geom_boxplot(color = "blue", aes(group = cut_width(Height, 5, boundary = 165)))

ggplot(data = pd101_s2_tbl1, aes(x = Height, y = ranking)) + 
  geom_boxplot(color = "blue", aes(group = cut_number(Height, 5, boundary = 165)))
```

##Height, age and ranking
```{r, eval=F}
ggplot(pd101_s2_tbl1, aes(x = Height, y = Age)) +
  geom_tile(mapping = aes(fill = ranking_ep1))
```

##Training period
```{r, eval=F}
ggplot(data = pd101_s2_tbl1, mapping = aes(x = Training_time)) +
  geom_histogram(bins = 5, color = "blue") 

ggplot(data = pd101_s2_tbl1, mapping = aes(x = Training_time)) +
  geom_histogram(bins = 10, color = "blue") 
```

##Training period and ranking
```{r, eval=F}
ggplot(data = pd101_s2_tbl1, mapping = aes(x = Training_time, y = ranking)) +
  geom_point(color = "blue") 

ggplot(data = pd101_s2_tbl1, mapping = aes(x = Training_time, y = ranking)) +
  geom_boxplot(color = "blue", aes(group = cut_number(Training_time, 10)))

ggplot(data = pd101_s2_tbl1, mapping = aes(x = Training_time, y = ranking)) +
  geom_boxplot(color = "blue", aes(group = cut_width(Training_time, 30, boundary = 0)))
```

##When did they start training
```{r, eval=F}
pd101_s2_tbl1 <- pd101_s2_tbl1 %>%
  mutate(start_age = age - Training_time/12)

ggplot(data = pd101_s2_tbl1, mapping = aes(x = start_age)) +
  geom_histogram(bins = 10, color = "blue") 
```

##Age when training started and ranking
###Generally people who started earlier have a higher rank
```{r, eval=F}
ggplot(data = pd101_s2_tbl1, mapping = aes(x = start_age, y = ranking)) +
  geom_point(color = "blue") 

ggplot(data = pd101_s2_tbl1, mapping = aes(x =start_age, y = ranking)) +
  geom_boxplot(color = "blue", aes(group = cut_number(start_age, 5)))

ggplot(data = pd101_s2_tbl1, mapping = aes(x = start_age, y = ranking)) +
  geom_boxplot(color = "blue", aes(group = cut_width(start_age, 5, boundary = 0)))
```
##Weight
```{r, eval=F}
ggplot(data = pd101_s2_tbl1, mapping = aes(Weight)) +
  geom_histogram(bins = 10, color = "blue") 

ggplot(data = pd101_s2_tbl1, mapping = aes(x = Weight, y = Height)) +
  geom_jitter(color = "blue") 
```

#if there's a big change between the ranking in first episode and last
#female heights
#if company influences ranking: both female and male ranking
#if training time influences ranking
#if when they started training influences ranking

#ggplotly


#slides should be self explanatory
#put web link for produce 101, why explain
#https://www.wattpad.com/209127413-produce-101-profiles-season-1-018-zhou-jieqiong-%E2%98%86

```{r, eval=F}
str_to_lower("Age", locale = "en")
```

write a method for exploring simple distribution of data
https://stackoverflow.com/questions/27773881/r-object-not-found-if-defined-within-a-function-when-using-data-table-dplyr
```{r, eval=F}
set.seed(100)
d <- diamonds[sample(nrow(diamonds), 1000), ]


p <- ggplot(data = d, aes(x = carat, y = price)) +
  geom_point(size = 4) +
  geom_smooth(aes(colour = cut, fill = cut)) + facet_wrap(~ cut)

p <- ggplotly(p)
p
```



rlang::UQ(rlang::sym("cyl"))

eval(parse(text = y))